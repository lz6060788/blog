## ADDED Requirements

### 需求：后台路由保护

系统应使用 Next.js Middleware 保护 `/admin` 路径及其所有子路由，确保只有已登录用户可以访问。

#### 场景：已登录用户访问后台

- **当** 用户已登录（存在有效会话）
- **且** 用户访问 `/admin` 或 `/admin/*` 路径
- **则** 系统允许访问请求的后台页面
- **且** 不进行任何重定向

#### 场景：未登录用户访问后台

- **当** 用户未登录（不存在有效会话）
- **且** 用户访问 `/admin` 或 `/admin/*` 路径
- **则** 系统将用户重定向到 `/login`
- **且** 重定向 URL 包含 `callbackUrl` 参数，值为用户尝试访问的原始路径
- **且** 用户登录成功后自动返回原始请求的页面

#### 场景：博客前台路由不受保护

- **当** 用户访问 `/` 或其他非 `/admin` 路径
- **则** 系统不进行登录状态检查
- **且** 所有用户（包括未登录用户）都可以正常访问

### 需求：Middleware 配置

系统应在项目根目录创建或更新 `middleware.ts` 文件，配置路由保护规则。

#### 场景：保护配置匹配器

- **当** Middleware 被初始化
- **则** 配置匹配器包含 `/admin/:path*` 模式
- **且** 排除静态资源路径（`/_next/*`, `/static/*`, `/api/*`）
- **且** 排除登录页面路径（`/login`）

#### 场景：会话验证失败处理

- **当** Middleware 验证会话时发生错误
- **则** 系统将用户重定向到 `/login?error=AuthFailed`
- **且** 错误信息在登录页面显示给用户

### 需求：会话状态检查 API

系统应提供 API 端点供前端检查用户当前的登录状态。

#### 场景：检查登录状态

- **当** 前端调用 `/api/auth/session` 端点
- **则** 系统返回当前用户的会话信息
- **且** 如果用户已登录，返回包含用户信息的 JSON 对象
- **且** 如果用户未登录，返回 `null` 或空对象

#### 场景：后台页面轮询会话状态

- **当** 用户在后台页面活跃时
- **则** 前端定期（每 5 分钟）调用会话检查 API
- **且** 如果会话失效，显示提示并将用户重定向到登录页
