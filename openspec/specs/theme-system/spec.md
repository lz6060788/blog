## 新增需求

### 需求：保留当前亮色主题
系统应将当前项目使用的 zinc 色系保留为亮色主题，不改变现有视觉设计。

#### 场景：亮色主题颜色保留
- **当** 亮色主题激活时
- **那么** 系统应使用 zinc-50 (#fafafa) 作为主背景色
- **并且** 系统应使用 white (#ffffff) 作为卡片和容器背景
- **并且** 系统应使用 zinc-900 (#18181b) 作为主文本色
- **并且** 系统应使用 zinc-500 (#71717a) 作为次级文本色
- **并且** 系统应使用 zinc-200 (#e4e4e7) 作为边框和分割线颜色
- **并且** 系统应使用 emerald 系列作为强调色（emerald-50、emerald-400、emerald-700）

### 需求：CSS 自定义属性
系统应使用 CSS 自定义属性（CSS 变量）来设置所有主题颜色。

#### 场景：以项目变量为主的颜色系统
- **当** 定义主题颜色时
- **那么** 系统应创建以项目命名规范为主的 CSS 变量
- **并且** 项目变量使用语义化前缀（--bg-*、--text-*、--accent-* 等）
- **并且** 系统不在 `:root` 中创建 shadcn/ui 的别名变量（如 --background、--foreground）
- **并且** shadcn/ui 组件通过 Tailwind 配置映射到项目变量
- **并且** 如果组件需要新的语义颜色，扩展现有的变量系列（如添加 --bg-* 变量）
- **并且** 系统应使用语义化前缀便于理解和维护
- **并且** 变量应可在运行时更新而无需重新构建

### 需求：shadcn/ui 圆角变量

系统应添加圆角 CSS 变量以支持 shadcn/ui 组件的圆角配置。

#### 场景：添加圆角变量

- **当** 主题系统初始化时
- **则** 系统在 `:root` 中添加 `--radius` CSS 变量
- **且** `--radius` 设置为 `1rem`（对应 Tailwind 的 `rounded-2xl`）
- **且** 深色模式下使用相同的 `--radius` 值

#### 场景：组件使用圆角变量

- **当** 组件需要引用圆角值
- **则** 组件可使用 `rounded-[var(--radius)]` 引用该变量
- **且** 组件可以根据类型覆盖该值（如 Button 使用 `rounded-xl`）

### 需求：Tailwind 颜色映射

系统应在 Tailwind 配置中添加 shadcn/ui 所需的颜色定义，映射到项目现有的 CSS 变量。

#### 场景：配置 shadcn/ui 基础颜色

- **当** Tailwind 配置加载时
- **则** 系统在 `tailwind.config.ts` 中定义 shadcn/ui 颜色
- **且** `background` 映射到 `var(--bg-canvas)`
- **且** `foreground` 映射到 `var(--text-canvas)`
- **且** `card` 映射到 `var(--card-bg)`
- **且** `popover` 映射到 `var(--bg-surface)`
- **且** `primary` 映射到 `var(--accent-primary)`
- **且** `secondary` 映射到 `var(--bg-muted)`
- **且** `muted` 映射到 `var(--bg-muted)`
- **且** `accent` 映射到 `var(--accent-bg)`
- **且** `destructive` 映射到 `var(--error-primary)`
- **且** `border` 映射到 `var(--border-default)`
- **且** `input` 映射到 `var(--input-bg)`
- **且** `ring` 映射到 `var(--accent-primary)`
- **且** `radius` 映射到 `var(--radius)`

#### 场景：shadcn/ui 组件使用 Tailwind 颜色类

- **当** shadcn/ui 组件使用 `bg-background` 类名
- **则** Tailwind 将其解析为 `background-color: var(--bg-canvas)`
- **且** 颜色值直接使用项目的 CSS 变量
- **且** 无需创建额外的 shadcn/ui 别名变量

#### 场景：深色模式下的颜色映射

- **当** 系统切换到深色模式
- **则** 所有 Tailwind 颜色类自动使用深色模式的 CSS 变量值
- **且** `bg-background` 使用深色的 `--bg-canvas`（zinc-950）
- **且** `text-foreground` 使用深色的 `--text-canvas`（zinc-50）
- **且** 其他颜色相应映射

### 需求：shadcn/ui 配置文件

系统应生成 `components.json` 配置文件以支持 shadcn/ui CLI 工具。

#### 场景：生成配置文件

- **当** 开发者运行 `npx shadcn@latest init` 命令
- **则** 系统在项目根目录生成 `components.json` 文件
- **且** 配置文件设置 `tailwind.config` 路径为 `tailwind.config.ts`
- **且** 配置文件设置 `cssVars` 为 `true`（使用 CSS 变量）
- **且** 配置文件设置组件路径为 `@/components/ui`
- **且** 配置文件设置工具函数路径为 `@/lib/utils`

#### 场景：配置文件使用项目颜色映射

- **当** `components.json` 生成时
- **则** 配置不定义 shadcn/ui 的默认颜色变量
- **且** shadcn/ui 组件通过 Tailwind 配置映射到项目变量
- **且** 保持项目 CSS 变量作为唯一的事实来源

### 需求：暗色模式色彩设计
系统应根据 frontend-design 美学规范设计暗色主题，确保与亮色主题形成协调对比而非简单反转。

#### 场景：暗色主题背景色
- **当** 暗色主题激活时
- **那么** 系统应使用深色调作为主背景（推荐 zinc-950 #09090b 或更深的自定义色）
- **并且** 系统应使用稍浅的色调作为次级背景（推荐 zinc-900 #18181b）
- **并且** 系统应确保背景色之间有足够的层次感但不刺眼

#### 场景：暗色主题文本色
- **当** 暗色主题激活时
- **那么** 系统应使用浅色调作为主文本（推荐 zinc-50 或 zinc-100）
- **并且** 系统应使用中等浅色调作为次级文本（推荐 zinc-400）
- **并且** 系统应确保文本与背景对比度符合 WCAG AA 标准（至少 4.5:1）

#### 场景：暗色主题边框色
- **当** 暗色主题激活时
- **那么** 系统应使用低对比度的边框色（推荐 zinc-800）
- **并且** 边框应在深色背景上微妙可见但不突兀

#### 场景：暗色主题强调色
- **当** 暗色主题激活时
- **那么** 系统应调整 emerald 强调色以在深色背景上保持良好可见性
- **并且** 系统可能需要使用更亮的 emerald 变体（如 emerald-400、emerald-500）
- **并且** 强调色背景应使用更深的变体（如 emerald-950）

### 需求：三种主题模式
系统应支持三种主题模式：浅色、深色和自动（系统偏好）。

#### 场景：浅色模式选择
- **当** 用户选择浅色模式时
- **那么** 系统应应用当前项目的 zinc 亮色主题
- **并且** 系统应持久化选择

#### 场景：深色模式选择
- **当** 用户选择深色模式时
- **那么** 系统应应用精心设计的暗色主题
- **并且** 系统应持久化选择

#### 场景：自动模式选择
- **当** 用户选择自动模式时
- **那么** 系统应检测系统颜色方案偏好
- **并且** 系统应根据操作系统设置应用浅色或深色主题
- **并且** 默认应为浅色主题以保持项目原有视觉风格

### 需求：主题持久化
系统应使用 localStorage 在浏览器会话之间持久化用户的主题偏好。

#### 场景：保存主题偏好
- **当** 用户更改主题选择时
- **那么** 系统应将偏好保存到 localStorage
- **并且** 系统应使用 "blog-theme" 键

#### 场景：加载主题偏好
- **当** 应用程序加载时
- **那么** 系统应从 localStorage 读取主题偏好
- **并且** 系统应应用已保存的主题（如果可用）
- **并且** 系统应在不存在偏好时默认为浅色主题

### 需求：Tailwind CSS 集成
系统应将 CSS 自定义属性与 Tailwind CSS 配置集成。

#### 场景：Tailwind 颜色映射（shadcn/ui 支持）
- **当** Tailwind 处理样式时
- **那么** 系统应在 Tailwind 配置中扩展颜色定义
- **并且** 扩展应包含 shadcn/ui 所需的颜色（background、foreground、primary、secondary 等）
- **并且** 这些颜色通过 CSS() 函数引用项目的 CSS 变量（如 background: 'var(--bg-canvas)'）
- **并且** 确保所有现有类名继续工作（bg-zinc-50、text-zinc-900 等）
- **并且** 新增 shadcn/ui 颜色类名（bg-background、text-foreground 等）
- **并且** 新增类名在深色/浅色模式下自动使用正确的变量值

### 需求：主题上下文提供程序
系统应提供用于整个应用程序主题状态管理的 React 上下文。

#### 场景：主题提供程序设置
- **当** 应用程序挂载时
- **那么** 系统应使用 ThemeProvider 包装应用程序
- **并且** 提供程序应向子组件公开当前主题和 setTheme 函数
- **并且** 默认主题应为浅色以保持项目原有视觉风格

#### 场景：主题切换访问
- **当** 组件需要主题信息时
- **那么** 组件应使用 useTheme hook
- **并且** hook 应返回 { theme, setTheme } 对象
- **并且** theme 值应为 'light' | 'dark' | 'system'

### 需求：主题切换组件
系统应提供主题切换 UI 组件，用于在浅色、深色和自动模式之间切换。

#### 场景：主题切换器显示
- **当** 渲染主题切换组件时
- **那么** 系统应显示三个选项：浅色、深色、自动
- **并且** 系统应指示当前活动的主题
- **并且** 系统应在用户选择不同选项时更新主题
- **并且** 切换器应遵循 frontend-design 美学规范，具有精致的视觉效果

### 需求：平滑主题过渡
系统应在主题之间切换时应用平滑的 CSS 过渡效果，确保颜色切换自然流畅。

#### 场景：主题更改动画
- **当** 用户在主题之间切换时
- **那么** 系统应向 background-color、color、border-color 等颜色属性应用 300ms 过渡效果
- **并且** 过渡时间函数应使用 ease-in-out 曲线
- **并且** 系统应避免对非颜色属性（如布局）应用过渡以防止视觉跳动

### 需求：视觉一致性
系统应确保暗色主题保持与亮色主题相同的设计语言和美学风格。

#### 场景：设计语言保持
- **当** 暗色主题激活时
- **那么** 系统应保持相同的圆角风格（rounded-[2rem]）
- **并且** 系统应保持相同的阴影效果（可能需要调整颜色值）
- **并且** 系统应保持相同的间距和布局比例
- **并且** 系统应确保所有交互状态（hover、focus）在两种主题下都有清晰的视觉反馈
